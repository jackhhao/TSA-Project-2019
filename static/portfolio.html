<!DOCTYPE HTML>
<!--
	Theory by TEMPLATED
	templated.co @templatedco
	Released for free under the Creative Commons Attribution 3.0 license (templated.co/license)
-->
<html>
	<head>
		<title>Elements - Theory by TEMPLATED</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<link rel="stylesheet" href="../assets/main.css" />
	</head>
	<body onload = "populate()" class="subpage">

		<!-- Header -->
			<header id="header">
				<div class="inner">
					<a href="/theory" class="logo">Theory</a>
					<nav id="nav">
						<a href="/">Home</a>
						<a href="/stocks">Stocks</a>
						<a href="/portfolio">Portfolio</a>
					</nav>
					<a href="#navPanel" class="navPanelToggle"><span class="fa fa-bars"></span></a>
				</div>
			</header>

		<!-- Main -->
			<section id="main" class="wrapper">
				<div class="inner">
					<header class="align-center">
						<h2>Portfolio</h2>
						<p>Track Selected Stocks</p>
					</header>
				<div class = "flex flex 2" id = "flex-div"></div>

				<div class = "output">
					<p><b>

					<p id='paragraph'></p>
					<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>

					<!-- <script>
					let count = 0;
					$('#addColumnChild').click(function(){
						 $(`tr${count}`).each(function(){
							 for(let i=0; i<)
								$(this).append(`<td></td>`);
						 });
						});

						$('#addRowChild').click(function(){
						 $('#my-table tbody').append(`<tr>${$('#default-row').html()}</tr>`);
						});
					</script> -->

					<script>
					let rows = 0;
					let cols = 7;

						// function populate(rows){
						// 	let table = document.getElementById("stockTable")
						// 	let r=1;
						// 	while(row=table.rows[r++])
						// 	{
						// 		row.cells[0].innerHTML = localStorage.getItem(`stock${r-2}`)
						// 	}
						//
						// 	$('#addColumnChild').click(function(){
						// 		 $(`tr${count}`).each(function(){
						// 			 for(let i=0; i<10;i++)
						// 				$(this).append(`<td></td>`);
						// 		 });
						// 		});
						//
						// 		$('#addRowChild').click(function(){
						// 		 $('#my-table tbody').append(`<tr>${$('#default-row').html()}</tr>`);
						// 		});
						// }

						function setP(rowNum, ticker){
							$.get("/price", {v: ticker}, function(result){
								let newResult;
								if (!(isNaN(result)))
								{
									newResult = "$" + parseFloat(result).toFixed(2).toString();
								}
								else
								{
									newResult = "None";
								}
								$("#" + `p${rowNum}`).text(newResult);
							})
						}

						function setT(rowNum){
							let result = localStorage.getItem(`stock${rowNum-1}`)
							console.log(result)
							document.getElementById(`t${rowNum}`).innerHTML = result
								setP(rowNum, result)
								setR(rowNum, result)
								setH(rowNum, result)
								setL(rowNum, result)
						}

						function setR(rowNum, ticker){
							$.get("/suggest_full", {v: ticker}, function(result){
								$ ("#" + `r${rowNum}`).text(parseFloat(result).toFixed(4).toString());
							})
						}

						function setH(rowNum, ticker){
							$.get("/getHigh", {v: ticker}, function(result){
								$ ("#" + `rb${rowNum}`).text(parseFloat(result).toFixed(2).toString());
							})
						}

						function setL(rowNum, ticker){
							$.get("/getLow", {v: ticker}, function(result){
								$ ("#" + `rs${rowNum}`).text(parseFloat(result).toFixed(2).toString());
							})
						}

						function populate(){

							let cols = 5
							let rowsFill = localStorage.length-1
							console.log(rowsFill)
							$("#flex-div").append(`<table id = "stockTable" class = "tableVals"></table>`)
							$("#stockTable").empty()
							$('#stockTable div').html('');
							$("#stockTable").append(`<tr id = "headers">
								<th id = "tickerHeader"><center>Stock Ticker</center></th>
								<th id = "ratingHeader"><center>Our Rating</center></th>
								<th id = "priceHeader"><center>Current Price</center></th>
								<th id = "rBuyHeader"><center>Recommend Buy Price</center></th>
								<th id = "rSellHeader"><center>Recommend Sell Price</center></th>
							</tr>`)

							for(let i = 0; i < rowsFill; i++){
								$("#stockTable").append(`<tr class = "row${i + 1}" id = "row${i+1}"></tr>`);
								for (let j = 0; j < cols; j++)
								{
									var rowID;
									switch(j)
									{
										case 0:
											rowID = `t${i + 1}`
											break;
										case 1:
											rowID = `r${i + 1}`
											break;
										case 2:
											rowID = `p${i + 1}`
											break;
										case 3:
											rowID = `rb${i+1}`
											break;
										case 4:
											rowID = `rs${i+1}`
											break;
									}
									$(`#row${i+1}`).append(`<td id = "${rowID}"><center></center></td>`)
								}
								console.log(document.getElementById("stockTable").innerHTML);
}
								let r=1;
								let table = document.getElementById("stockTable");
								while(row=table.rows[r++])
								{
								  let c=0;
								  while(cell=row.cells[c++]){cell.innerHTML="";}
								}
								for(let x = 1; x < rowsFill + 1; x++){
									setT(x)
								}
							}
						window.onload=populate;
					</script>


		<!-- Footer -->
			<footer id="footer">
				<div class="inner">
					<div class="flex">
						<div class="copyright">
							&copy; Untitled. Design: <a href="https://templated.co">TEMPLATED</a>. Images: <a href="https://unsplash.com">Unsplash</a>.
						</div>
						<ul class="icons">
							<li><a href="#" class="icon fa-facebook"><span class="label">Facebook</span></a></li>
							<li><a href="#" class="icon fa-twitter"><span class="label">Twitter</span></a></li>
							<li><a href="#" class="icon fa-linkedin"><span class="label">linkedIn</span></a></li>
							<li><a href="#" class="icon fa-pinterest-p"><span class="label">Pinterest</span></a></li>
							<li><a href="#" class="icon fa-vimeo"><span class="label">Vimeo</span></a></li>
						</ul>
					</div>
				</div>
			</footer>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/skel.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>

	</body>
</html>
